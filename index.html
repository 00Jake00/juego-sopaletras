<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sopa de Letras - Amor y Amistad</title>
  <style>
    body {
      font-family: 'Comfortaa', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #fff0f5;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      background-image: url('https://github.com/00Jake00/juego-sopaletras/blob/main/DPCC_Campan%CC%83a%20Amor%20y%20Amistad_FondoJuegos_Fondo-H.jpg?raw=true');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    @media (max-width: 575.98px){
      body {
        background-image: url('https://github.com/00Jake00/juego-sopaletras/blob/main/DPCC_Campan%CC%83a%20Amor%20y%20Amistad_FondoJuegos_Fondo-V.jpg?raw=true');
      }
    }

    h1 {
      color: #d63384;
      text-align: center;
      margin-top: 60px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      width: 100%;
      max-width: 500px;
      aspect-ratio: 1 / 1;
      gap: 2px;
      margin: 20px 0;
      touch-action: none;
    }
    .cell {
      background-color: white;
      border: 1px solid #ccc;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      user-select: none;
      cursor: pointer;
      font-size: 1.2rem;
    }
    .cell.selected {
      background-color: #d63384;
      color: white;
    }
    .cell.found {
      background-color: #ffc0cb;
      color: white;
    }

    .panel {
      margin-top: 20px;
      background: #fff;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 500px;
      text-align: center;
    }
    .word-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
    }
    .word {
      background: #f8d7da;
      padding: 5px 10px;
      border-radius: 5px;
      font-weight: bold;
    }
    .word.found {
      background: #c3e6cb;
    }

    /* === Logos en esquinas (desktop) === */
    .corner {
      position: fixed;
      top: 10px;
      width: 100px;
      z-index: 1000;
      pointer-events: none;
    }
    .logo-left { left: 10px; }
    .logo-right { right: 10px; }

    /* === Ajuste móvil: logos no fijos, bajan al flujo === */
    @media (max-width: 575.98px){
      .corner{
        position: static;
        display: block;
        margin: 6px auto 8px;
        width: clamp(72px, 32vw, 110px);
        z-index: auto;
        pointer-events: none;
      }
      .logo-left{ left:auto; }
      .logo-right{ right:auto; }
    }

    /* Popup reflexiones */
    .popup {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      display: flex;
      justify-content: center;
      align-items: center;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s ease, visibility 0.3s ease;
      z-index: 2000;
    }
    .popup.active {
      visibility: visible;
      opacity: 1;
    }
    .popup-content {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      max-width: 400px;
      text-align: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      position: relative;
    }
    .popup-content p {
      margin: 0;
      font-style: italic;
      color: #333;
    }
    .popup-close {
      position: absolute;
      top: 8px;
      right: 12px;
      cursor: pointer;
      font-weight: bold;
      color: #d63384;
    }
  </style>
</head>
<body>
  <!-- Logos -->
  <img src="https://github.com/00Jake00/juego-sopaletras/blob/main/LOGO.png?raw=true" alt="Logo equipo" class="corner logo-left">
  <img src="https://github.com/00Jake00/juego-sopaletras/blob/main/BTA.png?raw=true" alt="Logo campaña" class="corner logo-right">

  <h1>Palabras que construyen Amor y Amistad</h1>

  <div class="grid" id="sopa"></div>

  <div class="panel">
    <div class="word-list" id="lista-palabras"></div>
  </div>

  <!-- Popup -->
  <div class="popup" id="popup">
    <div class="popup-content">
      <span class="popup-close" id="popupClose">X</span>
      <p id="popupText"></p>
    </div>
  </div>

  <script>
    const tam = 12;
    const grid = Array.from({ length: tam }, () => Array(tam).fill(""));
    const palabras = [
      { texto: "CONVIVENCIA", reflexion: "La mejor celebración es la que se vive pacíficamente.", coords: [] },
      { texto: "AMISTAD", reflexion: "Compartir con respeto y cuidado fortalece la amistad.", coords: [] },
      { texto: "CORRESPONSABILIDAD", reflexion: "El bienestar se construye cuidando de nosotros y de los demás.", coords: [] },
      { texto: "UNION", reflexion: "Celebremos en paz: sin violencia, sin drama, solo unión.", coords: [] },
      { texto: "RESPETO", reflexion: "Si hay golpe y agresión, se daña la celebración.", coords: [] },
      { texto: "SOLIDARIDAD", reflexion: "Ayudar y acompañar también es celebrar el amor y la amistad.", coords: [] },
      { texto: "ALEGRIA", reflexion: "Celebremos con alegría, responsabilidad y empatía en cada decisión.", coords: [] },
      { texto: "EMOCION", reflexion: "Gestiona tus emociones: evita las riñas, que el amor sea la celebración.", coords: [] },
      { texto: "EMPATIA", reflexion: "Celebrar con empatía: comprender y cuidar hace la fiesta más bonita.", coords: [] },
      { texto: "AUTORREGULACION", reflexion: "Controla tus actos para que la celebración termine sin nada que lamentar.", coords: [] },
      { texto: "AMOR", reflexion: "Cuidar cómo celebramos es cuidar la vida de quienes amamos.", coords: [] }
    ];

    const direcciones = [
      [0, 1], [1, 0], [1, 1], [-1, 1],
      [0, -1], [-1, 0], [-1, -1], [1, -1]
    ];

    function puedeColocar(palabra, row, col, dx, dy) {
      for (let i = 0; i < palabra.length; i++) {
        const r = row + i * dy;
        const c = col + i * dx;
        if (r < 0 || r >= tam || c < 0 || c >= tam || (grid[r][c] && grid[r][c] !== palabra[i])) return false;
      }
      return true;
    }

    function colocarPalabra(p) {
      let placed = false;
      let intentos = 0;

      while (!placed && intentos < 200) {
        const dir = direcciones[Math.floor(Math.random() * direcciones.length)];
        const dx = dir[0];
        const dy = dir[1];
        const row = Math.floor(Math.random() * tam);
        const col = Math.floor(Math.random() * tam);

        if (puedeColocar(p.texto, row, col, dx, dy)) {
          const coords = [];
          for (let i = 0; i < p.texto.length; i++) {
            const r = row + i * dy;
            const c = col + i * dx;
            grid[r][c] = p.texto[i];
            coords.push(`${r}-${c}`);
          }
          p.coords = coords;
          placed = true;
        }
        intentos++;
      }
      if (!placed) console.warn(`No se pudo colocar la palabra: ${p.texto}`);
    }

    function rellenarLetras() {
      const letras = "ABCDEFGHIJKLMNÑOPQRSTUVWXYZ";
      for (let i = 0; i < tam; i++) {
        for (let j = 0; j < tam; j++) {
          if (!grid[i][j]) {
            grid[i][j] = letras[Math.floor(Math.random() * letras.length)];
          }
        }
      }
    }

    const sopa = document.getElementById("sopa");
    const lista = document.getElementById("lista-palabras");
    const popup = document.getElementById("popup");
    const popupText = document.getElementById("popupText");
    const popupClose = document.getElementById("popupClose");

    function renderSopa() {
      sopa.innerHTML = "";
      for (let i = 0; i < tam; i++) {
        for (let j = 0; j < tam; j++) {
          const div = document.createElement("div");
          div.className = "cell";
          div.id = `${i}-${j}`;
          div.textContent = grid[i][j];
          sopa.appendChild(div);
        }
      }
    }

    function mostrarPalabras() {
      lista.innerHTML = "";
      palabras.forEach(p => {
        const span = document.createElement("span");
        span.className = "word";
        span.id = `palabra-${p.texto}`;
        span.textContent = p.texto;
        lista.appendChild(span);
      });
    }

    let seleccion = [];
    let seleccionActiva = false;

    function iniciarEventos() {
      sopa.addEventListener("mousedown", empezarSeleccion);
      sopa.addEventListener("mousemove", arrastrarSeleccion);
      sopa.addEventListener("mouseup", finalizarSeleccion);
      sopa.addEventListener("touchstart", empezarSeleccionTouch, { passive: false });
      sopa.addEventListener("touchmove", arrastrarSeleccionTouch, { passive: false });
      sopa.addEventListener("touchend", finalizarSeleccion);
    }

    function empezarSeleccion(e) {
      seleccionActiva = true;
      seleccion = [];
      limpiarSeleccion();
      const target = e.target.closest(".cell");
      if (target) seleccionarCelda(target);
    }

    function arrastrarSeleccion(e) {
      if (!seleccionActiva) return;
      const target = e.target.closest(".cell");
      if (target && !seleccion.includes(target.id)) seleccionarCelda(target);
    }

    function empezarSeleccionTouch(e) {
      e.preventDefault();
      seleccionActiva = true;
      seleccion = [];
      limpiarSeleccion();
      const touch = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);
      if (touch && touch.classList.contains("cell")) seleccionarCelda(touch);
    }

    function arrastrarSeleccionTouch(e) {
      e.preventDefault();
      if (!seleccionActiva) return;
      const touch = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);
      if (touch && touch.classList.contains("cell") && !seleccion.includes(touch.id)) seleccionarCelda(touch);
    }

    function finalizarSeleccion() {
      seleccionActiva = false;
      const palabraActual = seleccion.map(id => document.getElementById(id).textContent).join("");
      const match = palabras.find(p => p.texto === palabraActual && p.coords.every((c, i) => seleccion[i] === c));
      if (match) {
        match.coords.forEach(id => {
          const cell = document.getElementById(id);
          cell.classList.remove("selected");
          cell.classList.add("found");
        });
        document.getElementById(`palabra-${match.texto}`).classList.add("found");
        popupText.textContent = match.reflexion;
        popup.classList.add("active");
      } else {
        limpiarSeleccion();
      }
      seleccion = [];
    }

    function seleccionarCelda(el) {
      el.classList.add("selected");
      seleccion.push(el.id);
    }

    function limpiarSeleccion() {
      document.querySelectorAll(".cell.selected").forEach(c => c.classList.remove("selected"));
    }

    popupClose.addEventListener("click", () => {
      popup.classList.remove("active");
    });

    palabras.forEach(p => colocarPalabra(p));
    rellenarLetras();
    renderSopa();
    mostrarPalabras();
    iniciarEventos();
  </script>
</body>
</html>
