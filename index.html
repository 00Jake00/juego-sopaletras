<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sopa de Letras - Amor y Amistad</title>

  <!-- Tipografía -->
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --magenta:#d63384;
      --magenta-soft:#ffc0cb;
      --ok:#2ecc71;
      --panel:#ffffff;
      --shadow:0 8px 30px rgba(0,0,0,.08);
    }

    *{ box-sizing:border-box; }

    html, body { height: 100%; }

    /* Fondo responsive por dispositivo */
    body{
      margin:0; padding:20px;
      font-family: 'Comfortaa', system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      color:#111;
      min-height:100vh;
      background: center/cover no-repeat fixed
        url("https://raw.githubusercontent.com/00Jake00/juego-sopaletras/main/DPCC_Campan%CC%83a%20Amor%20y%20Amistad_FondoJuegos_Fondo-H.jpg");
    }
    @media (max-width: 575.98px){
      body{
        padding:16px;
        background-image: url("https://raw.githubusercontent.com/00Jake00/juego-sopaletras/main/DPCC_Campan%CC%83a%20Amor%20y%20Amistad_FondoJuegos_Fondo-V.jpg");
      }
    }

    /* Logos fijos en las esquinas (siempre visibles) */
    .logo-fixed{
      position: fixed;
      top: max(12px, env(safe-area-inset-top));
      z-index: 1000;
      display:block;
      filter: drop-shadow(0 2px 8px rgba(0,0,0,.25));
    }
    .logo-left{ left: max(12px, env(safe-area-inset-left)); }
    .logo-right{ right: max(12px, env(safe-area-inset-right)); }

    /* Tamaños logos */
    .logo-fixed img{ display:block; height:54px; width:auto; }
    @media (min-width: 992px){
      .logo-fixed img{ height:72px; }
    }
    @media (max-width: 575.98px){
      .logo-fixed img{ height:44px; }
    }

    /* Contenedor principal */
    .wrap{
      width:100%;
      max-width: 1000px;
      margin:0 auto;
      background: rgba(255,255,255,.85);
      backdrop-filter: blur(2px);
      border-radius: 16px;
      box-shadow: var(--shadow);
      padding: 18px;
      /* separa contenido del header fijo con logos */
      margin-top: 84px;
    }
    @media (max-width:575.98px){
      .wrap{ margin-top: 76px; padding: 14px; }
    }

    h1{
      color: var(--magenta);
      text-align:center;
      margin: 0 0 .35rem 0;
      font-size: clamp(20px, 5vw, 32px);
      line-height:1.15;
    }
    .sub{
      text-align:center;
      margin:0 0 10px 0;
      font-size: clamp(14px, 3.6vw, 16px);
      color:#111;
      font-weight: 700;
    }

    /* Grilla del juego */
    .grid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      width: 100%;
      max-width: 520px;
      aspect-ratio: 1/1;
      gap: 2px;
      margin: 16px auto;
      touch-action: none; /* ayuda con selección táctil */
      user-select: none;
    }
    .cell{
      background-color: #fff;
      border: 1px solid #ccc;
      display:flex; align-items:center; justify-content:center;
      font-weight: 700;
      cursor: pointer;
      font-size: clamp(14px, 3.2vw, 20px);
    }
    .cell.selected{
      background-color: var(--magenta);
      color:#fff;
    }
    .cell.found{
      background-color: var(--magenta-soft);
      color:#fff;
    }

    /* Panel con lista de palabras */
    .panel{
      margin: 14px auto 0;
      background: var(--panel);
      padding: 14px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      max-width: 520px;
      text-align:center;
    }
    .word-list{
      display:flex; flex-wrap:wrap; justify-content:center; gap:8px;
    }
    .word{
      background:#f8d7da;
      padding:6px 10px;
      border-radius: 999px;
      font-weight:700;
      font-size: 14px;
    }
    .word.found{ background:#c3e6cb; }

    /* Modal / Popup */
    #popup{
      position: fixed;
      inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center; justify-content:center;
      z-index: 1200;
      padding: 16px;
    }
    #popup.show{ display:flex; }
    #popup .card{
      background:#fff;
      width: min(560px, 92vw);
      border-radius: 14px;
      box-shadow: 0 14px 46px rgba(0,0,0,.22);
      padding: 18px 18px 14px;
      text-align: center;
      position: relative;
    }
    #popup .title{
      margin: 0 0 8px 0;
      font-size: clamp(16px, 4.2vw, 20px);
      color:#111;
    }
    #popup .msg{
      margin:0;
      font-size: clamp(15px, 4vw, 18px);
      line-height: 1.4;
      color:#333;
    }
    #popup .magenta{
      color: var(--magenta);
      font-weight: 700;
      letter-spacing: .2px;
    }
    #popup .close{
      appearance:none; border:0; background:transparent; cursor:pointer;
      position:absolute; top:8px; right:8px;
      font-size: 20px; line-height:1; width:36px; height:36px;
      border-radius: 50%;
    }
    #popup .close:focus-visible{
      outline: 3px solid var(--magenta-soft); outline-offset: 2px;
    }
  </style>
</head>
<body>

  <!-- Logos fijos -->
  <a class="logo-fixed logo-left" href="#" aria-label="Logo campaña">
    <img src="https://raw.githubusercontent.com/00Jake00/juego-sopaletras/main/LOGO.png" alt="Logo campaña">
  </a>
  <a class="logo-fixed logo-right" href="#" aria-label="Logo ciudad">
    <img src="https://raw.githubusercontent.com/00Jake00/juego-sopaletras/main/BTA.png" alt="Logo Bogotá">
  </a>

  <main class="wrap" aria-labelledby="titulo">
    <h1 id="titulo">Palabras que construyen Amor y Amistad</h1>
    <p class="sub">Encuentra las parejas: <strong>palabra</strong> + <strong>mensaje</strong> que construyen vínculos sanos.</p>

    <div class="grid" id="sopa" role="grid" aria-label="Sopa de letras"></div>

    <div class="panel" aria-label="Lista de palabras">
      <div class="word-list" id="lista-palabras"></div>
    </div>
  </main>

  <!-- Popup -->
  <section id="popup" aria-modal="true" role="dialog" aria-labelledby="popup-title" aria-describedby="popup-msg">
    <div class="card">
      <button class="close" id="popupClose" aria-label="Cerrar">✕</button>
      <h2 class="title" id="popup-title">¡Palabra encontrada!</h2>
      <p class="msg" id="popup-msg"></p>
    </div>
  </section>

  <script>
    // === Configuración de la sopa ===
    const tam = 12;
    const grid = Array.from({ length: tam }, () => Array(tam).fill(""));
    const palabras = [
      { texto: "CONVIVENCIA",     reflexion: "La mejor celebración es la que se vive pacíficamente.", coords: [] },
      { texto: "AMISTAD",         reflexion: "Compartir con respeto y cuidado fortalece la amistad.", coords: [] },
      { texto: "CORRESPONSABILIDAD", reflexion: "El bienestar se construye cuidando de nosotros y de los demás.", coords: [] },
      { texto: "UNION",           reflexion: "Celebremos en paz: sin violencia, sin drama, solo unión.", coords: [] },
      { texto: "RESPETO",         reflexion: "Si hay golpe y agresión, se daña la celebración.", coords: [] },
      { texto: "SOLIDARIDAD",     reflexion: "Ayudar y acompañar también es celebrar el amor y la amistad.", coords: [] },
      { texto: "ALEGRIA",         reflexion: "Celebremos con alegría, responsabilidad y empatía en cada decisión.", coords: [] },
      { texto: "EMOCION",         reflexion: "Gestiona tus emociones: evita las riñas, que el amor sea la celebración.", coords: [] },
      { texto: "EMPATIA",         reflexion: "Celebrar con empatía: comprender y cuidar hace la fiesta más bonita.", coords: [] },
      { texto: "AUTORREGULACION", reflexion: "Controla tus actos para que la celebración termine sin nada que lamentar.", coords: [] },
      { texto: "AMOR",            reflexion: "Cuidar cómo celebramos es cuidar la vida de quienes amamos.", coords: [] },
    ];

    // 8 direcciones (incluye diagonales)
    const direcciones = [
      [0, 1], [1, 0], [1, 1], [-1, 1],
      [0, -1], [-1, 0], [-1, -1], [1, -1]
    ];

    function puedeColocar(palabra, row, col, dx, dy) {
      for (let i = 0; i < palabra.length; i++) {
        const r = row + i * dy;
        const c = col + i * dx;
        if (r < 0 || r >= tam || c < 0 || c >= tam || (grid[r][c] && grid[r][c] !== palabra[i])) return false;
      }
      return true;
    }

    function colocarPalabra(p) {
      let placed = false, intentos = 0;
      while (!placed && intentos < 300) {
        const [dx, dy] = direcciones[Math.floor(Math.random() * direcciones.length)];
        const row = Math.floor(Math.random() * tam);
        const col = Math.floor(Math.random() * tam);

        if (puedeColocar(p.texto, row, col, dx, dy)) {
          const coords = [];
          for (let i = 0; i < p.texto.length; i++) {
            const r = row + i * dy;
            const c = col + i * dx;
            grid[r][c] = p.texto[i];
            coords.push(`${r}-${c}`);
          }
          p.coords = coords;
          placed = true;
        }
        intentos++;
      }
      if (!placed) console.warn(`No se pudo colocar la palabra: ${p.texto}`);
    }

    function rellenarLetras() {
      const letras = "ABCDEFGHIJKLMNÑOPQRSTUVWXYZ";
      for (let i = 0; i < tam; i++) {
        for (let j = 0; j < tam; j++) {
          if (!grid[i][j]) {
            grid[i][j] = letras[Math.floor(Math.random() * letras.length)];
          }
        }
      }
    }

    const sopa = document.getElementById("sopa");
    const lista = document.getElementById("lista-palabras");

    function renderSopa() {
      sopa.innerHTML = "";
      for (let i = 0; i < tam; i++) {
        for (let j = 0; j < tam; j++) {
          const div = document.createElement("div");
          div.className = "cell";
          div.id = `${i}-${j}`;
          div.setAttribute('role','gridcell');
          div.textContent = grid[i][j];
          sopa.appendChild(div);
        }
      }
    }

    function mostrarPalabras() {
      lista.innerHTML = "";
      palabras.forEach(p => {
        const span = document.createElement("span");
        span.className = "word";
        span.id = `palabra-${p.texto}`;
        span.textContent = p.texto;
        lista.appendChild(span);
      });
    }

    // ===== Selección (táctil y mouse) =====
    let seleccion = [];
    let seleccionActiva = false;

    function seleccionarCelda(el) {
      el.classList.add("selected");
      if (!seleccion.includes(el.id)) seleccion.push(el.id);
    }

    function limpiarSeleccion() {
      document.querySelectorAll(".cell.selected").forEach(c => c.classList.remove("selected"));
    }

    function empezarSeleccion(e) {
      seleccionActiva = true;
      seleccion = [];
      limpiarSeleccion();
      const target = e.target.closest(".cell");
      if (target) seleccionarCelda(target);
    }
    function arrastrarSeleccion(e) {
      if (!seleccionActiva) return;
      const target = e.target.closest(".cell");
      if (target) seleccionarCelda(target);
    }
    function empezarSeleccionTouch(e) {
      e.preventDefault();
      seleccionActiva = true;
      seleccion = [];
      limpiarSeleccion();
      const touch = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);
      if (touch && touch.classList.contains("cell")) seleccionarCelda(touch);
    }
    function arrastrarSeleccionTouch(e) {
      e.preventDefault();
      if (!seleccionActiva) return;
      const touch = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);
      if (touch && touch.classList.contains("cell")) seleccionarCelda(touch);
    }

    // ===== Popup helpers =====
    const popup = document.getElementById('popup');
    const popupMsg = document.getElementById('popup-msg');
    const popupClose = document.getElementById('popupClose');
    function showPopup(htmlMsg){
      popupMsg.innerHTML = htmlMsg;
      popup.classList.add('show');
    }
    function hidePopup(){
      popup.classList.remove('show');
      popupMsg.innerHTML = '';
    }
    popupClose.addEventListener('click', hidePopup);
    popup.addEventListener('click', (e)=>{ if(e.target === popup) hidePopup(); });

    function finalizarSeleccion() {
      seleccionActiva = false;

      const texto = seleccion.map(id => document.getElementById(id).textContent).join("");
      // Coincide directo en orden
      let match = palabras.find(p => p.texto === texto && p.coords.every((c, i) => seleccion[i] === c));

      // También permitir al revés (arrastrar de derecha a izquierda / abajo-arriba)
      if (!match) {
        const textoRev = [...texto].reverse().join("");
        const selRev = [...seleccion].reverse();
        match = palabras.find(p => p.texto === textoRev && p.coords.every((c, i) => selRev[i] === c));
      }

      if (match) {
        // Marcar en grilla y lista
        match.coords.forEach(id => {
          const cell = document.getElementById(id);
          cell.classList.remove("selected");
          cell.classList.add("found");
        });
        document.getElementById(`palabra-${match.texto}`).classList.add("found");

        // Popup con palabra en magenta + reflexión
        const palabraMagenta = `<span class="magenta">${match.texto}</span>`;
        showPopup(`${palabraMagenta}<br>${match.reflexion}`);
      } else {
        limpiarSeleccion();
      }
      seleccion = [];
    }

    // Eventos
    function iniciarEventos() {
      sopa.addEventListener("mousedown", empezarSeleccion);
      sopa.addEventListener("mousemove", arrastrarSeleccion);
      window.addEventListener("mouseup", finalizarSeleccion);

      sopa.addEventListener("touchstart", empezarSeleccionTouch, { passive: false });
      sopa.addEventListener("touchmove", arrastrarSeleccionTouch,   { passive: false });
      window.addEventListener("touchend", finalizarSeleccion);
    }

    // Init
    palabras.forEach(p => colocarPalabra(p));
    rellenarLetras();
    renderSopa();
    mostrarPalabras();
    iniciarEventos();
  </script>
</body>
</html>



